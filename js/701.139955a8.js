"use strict";(self["webpackChunkbookkay"]=self["webpackChunkbookkay"]||[]).push([[701],{1391:(e,t,i)=>{i.r(t),i.d(t,{default:()=>j});var s=i(3673);(0,s.dD)("data-v-1f3eb652");const a=(0,s._)("div",{class:"heading"},[(0,s._)("h1",null,"My Works")],-1),n={key:0},o=(0,s._)("h2",{class:"sub-heading last-write"},[(0,s.Uk)("Continue "),(0,s._)("b",null,"writing...")],-1),l={key:1,class:"manuscripts-list"},r=(0,s._)("h2",{class:"sub-heading"},[(0,s.Uk)(" Which manuscripts would you like to work "),(0,s._)("b",null,"today?")],-1),c={key:2,class:"manuscripts-list"},d=(0,s._)("h2",{class:"sub-heading"},[(0,s.Uk)(" Want to edit back your publised "),(0,s._)("b",null,"manuscripts?")],-1);function p(e,t,i,p,u,m){const h=(0,s.up)("linking-box"),k=(0,s.up)("quick-book-link"),g=(0,s.up)("simple-book-list"),b=(0,s.up)("add-manuscript"),f=(0,s.up)("q-dialog"),y=(0,s.up)("q-page");return(0,s.wg)(),(0,s.j4)(y,null,{default:(0,s.w5)((()=>[a,(0,s._)("div",null,[(0,s.Wm)(h,{class:"write-link",mainText:"Just got an idea for the next best seller?",text:"Let's go write that down! What are you waiting for?",img:"svg/typewriter.svg",label:"Let's write!",onBtnClicked:t[0]||(t[0]=e=>u.addManuscriptDialog=!0)})]),u.unpublishedManuscripts.length>0?((0,s.wg)(),(0,s.iD)("div",n,[o,(0,s.Wm)(k,{book:u.unpublishedManuscripts[0],onBtnClicked:t[1]||(t[1]=e=>this.$router.push({name:"write-overview",params:{manuscript_id:u.unpublishedManuscripts[0].id}}))},null,8,["book"])])):(0,s.kq)("",!0),u.unpublishedManuscripts.length>1?((0,s.wg)(),(0,s.iD)("div",l,[r,(0,s.Wm)(g,{books:u.unpublishedManuscripts,primaryLabel:"Write",onPrimaryClicked:m.onPrimaryClicked,secondaryLabel:"Details",onSecondaryClicked:m.onSecondaryClicked},null,8,["books","onPrimaryClicked","onSecondaryClicked"])])):(0,s.kq)("",!0),u.publishedManuscripts.length>0?((0,s.wg)(),(0,s.iD)("div",c,[d,(0,s.Wm)(g,{books:u.publishedManuscripts,primaryLabel:"Edit",onPrimaryClicked:m.onPrimaryClicked,secondaryLabel:"Details",onSecondaryClicked:m.onSecondaryClicked},null,8,["books","onPrimaryClicked","onSecondaryClicked"])])):(0,s.kq)("",!0),(0,s.Wm)(f,{modelValue:u.addManuscriptDialog,"onUpdate:modelValue":t[3]||(t[3]=e=>u.addManuscriptDialog=e),class:"dialog"},{default:(0,s.w5)((()=>[(0,s.Wm)(b,{onDone:t[2]||(t[2]=e=>u.addManuscriptDialog=!1)})])),_:1},8,["modelValue"])])),_:1})}(0,s.Cn)();i(71),i(7098),i(246);var u=i(8880);(0,s.dD)("data-v-da193c0e");const m={class:"field"},h={class:"field"},k={class:"field"},g={class:"field"},b=(0,s._)("div",{class:"q-ml-md"},[(0,s._)("h4",null,"Types")],-1),f={class:"row q-mt-md"},y={key:0,class:"field component-list-item"},_={key:1,class:"field component-list-item"},v={key:2,class:"field component-list-item"},w={class:"field"};function C(e,t,i,a,n,o){const l=(0,s.up)("q-input"),r=(0,s.up)("q-select"),c=(0,s.up)("q-separator"),d=(0,s.up)("book-type-choices"),p=(0,s.up)("q-btn"),C=(0,s.up)("q-card-actions"),M=(0,s.up)("q-card");return(0,s.wg)(),(0,s.j4)(M,{class:"container"},{default:(0,s.w5)((()=>[(0,s._)("div",m,[(0,s.Wm)(l,{outlined:"",color:"black",modelValue:n.manuscript.title,"onUpdate:modelValue":t[0]||(t[0]=e=>n.manuscript.title=e),label:"Title",ref:"titleInput",rules:[e=>!!e||"Title is required"]},null,8,["modelValue","rules"])]),(0,s._)("div",h,[(0,s.Wm)(l,{outlined:"",color:"black",modelValue:n.manuscript.description,"onUpdate:modelValue":t[1]||(t[1]=e=>n.manuscript.description=e),label:"Description",type:"textarea",ref:"descriptionInput",rules:[e=>!!e||"Description is required"]},null,8,["modelValue","rules"])]),(0,s._)("div",k,[(0,s.Wm)(r,{outlined:"",color:"black",modelValue:n.manuscript.genre_name,"onUpdate:modelValue":t[2]||(t[2]=e=>n.manuscript.genre_name=e),options:n.genreOptions,label:"Genre"},null,8,["modelValue","options"])]),(0,s.Wm)(c,{inset:""}),(0,s._)("div",g,[b,(0,s._)("div",f,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(this.bookTypes,(e=>((0,s.wg)(),(0,s.j4)(d,{class:"col-4",bookType:e,key:e.id,onTypeConfirmed:o.confirmType},null,8,["bookType","onTypeConfirmed"])))),128))]),(0,s.Wm)(u.W3,{name:"component-list",tag:"div"},{default:(0,s.w5)((()=>[n.configs.contain_front_matter?((0,s.wg)(),(0,s.iD)("div",y,[(0,s.Wm)(p,{label:"Add Front Matter",ripple:{early:!0},onClick:t[3]||(t[3]=e=>o.addComponent("frontMatters")),class:"add-btn"}),(0,s.Wm)(u.W3,{name:"list",tag:"div"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.frontMatters,((e,t)=>((0,s.wg)(),(0,s.iD)("div",{key:t,class:"list-item"},[(0,s.Wm)(l,{outlined:"",color:"black",modelValue:e.title,"onUpdate:modelValue":t=>e.title=t,class:"component-title q-mb-md",label:"Title",rules:[e=>!!e||"Title is required"]},null,8,["modelValue","onUpdate:modelValue","rules"]),(0,s.Wm)(p,{color:"negative",icon:"delete",ripple:{early:!0},class:"delete-btn",onClick:e=>o.deleteComponent("frontMatters",t)},null,8,["onClick"])])))),128))])),_:1})])):(0,s.kq)("",!0),n.configs.contain_chapter?((0,s.wg)(),(0,s.iD)("div",_,[(0,s.Wm)(p,{label:"Add Chapter",ripple:{early:!0},onClick:t[4]||(t[4]=e=>o.addComponent("chapters")),class:"add-btn"}),(0,s.Wm)(u.W3,{name:"list",tag:"div"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.chapters,((e,t)=>((0,s.wg)(),(0,s.iD)("div",{key:t,class:"list-item"},[(0,s.Wm)(l,{outlined:"",color:"black",modelValue:e.title,"onUpdate:modelValue":t=>e.title=t,class:"component-title q-mb-md",label:"Title",rules:[e=>!!e||"Title is required"]},null,8,["modelValue","onUpdate:modelValue","rules"]),(0,s.Wm)(p,{color:"negative",icon:"delete",ripple:{early:!0},class:"delete-btn",onClick:e=>o.deleteComponent("chapters",t)},null,8,["onClick"])])))),128))])),_:1})])):(0,s.kq)("",!0),n.configs.contain_back_matter?((0,s.wg)(),(0,s.iD)("div",v,[(0,s.Wm)(p,{label:"Add Back Matter",ripple:{early:!0},onClick:t[5]||(t[5]=e=>o.addComponent("backMatters")),class:"add-btn"}),(0,s.Wm)(u.W3,{name:"list",tag:"div"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.backMatters,((e,t)=>((0,s.wg)(),(0,s.iD)("div",{key:t,class:"list-item"},[(0,s.Wm)(l,{outlined:"",color:"black",modelValue:e.title,"onUpdate:modelValue":t=>e.title=t,class:"component-title q-mb-md",label:"Title",rules:[e=>!!e||"Title is required"]},null,8,["modelValue","onUpdate:modelValue","rules"]),(0,s.Wm)(p,{color:"negative",icon:"delete",ripple:{early:!0},class:"delete-btn",onClick:e=>o.deleteComponent("backMatters",t)},null,8,["onClick"])])))),128))])),_:1})])):(0,s.kq)("",!0)])),_:1}),(0,s._)("div",w,[(0,s.Wm)(C,{align:"right"},{default:(0,s.w5)((()=>[(0,s.Wm)(p,{color:"positive",label:"Confirm",icon:"edit",ripple:{early:!0},onClick:o.confirm},null,8,["onClick"])])),_:1})])])])),_:1})}(0,s.Cn)();var M=i(6966);const W={name:"MakeManuscriptPage",components:{BookTypeChoices:M.Z},data(){return{configs:{},manuscript:{title:"",description:"",genre_name:"",temp_cover:"https://storage.googleapis.com/bookkay-dev.appspot.com/temp_covers/temp_cover.png",author_id:this.$store.getters["user/userProperty"]("id"),price:0,text:{}},genreOptions:[],bookTypes:[{id:"1",name:"Essay",configs:{contain_chapter:!1,contain_front_matter:!1,contain_back_matter:!1},hint:"A simple writing with no chapters.",chosen:!1},{id:"2",name:"Novel(Only chapters) ",configs:{contain_chapter:!0,contain_front_matter:!1,contain_back_matter:!1},hint:"A large long novels with several chapters.",chosen:!1},{id:"3",name:"Novel",configs:{contain_chapter:!0,contain_front_matter:!0,contain_back_matter:!0},hint:"A large long novels with several front matters, chapters and back matters.",chosen:!1}],frontMatters:[],chapters:[],backMatters:[]}},async mounted(){let e=await this.$api.get("genres"),t=e.data.results;for(const i of t)this.genreOptions.push(i.name)},methods:{confirmType(e){for(var t=0;t<this.bookTypes.length;t++){var i=this.bookTypes[t];i.configs==e?i.chosen=!0:i.chosen=!1}this.configs=e},capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)},addComponent(e){this[e].push({title:`${this.capitalizeFirstLetter(e).slice(0,-1)} - ${this[e].length+1}`,index:this[e].length,text:{time:1634195030352,blocks:[{id:"mEx28VKFcm",type:"heading",data:{text:`${this.capitalizeFirstLetter(e).slice(0,-1)} - ${this[e].length+1}`,level:3},tunes:{alignment:{alignment:"center"}}}],version:"2.22.2"}})},deleteComponent(e,t){let i=t;this[e].splice(t,1);for(const s of this[e])s.index>i&&s.index--},confirm(){this.$refs.titleInput.validate(),this.$refs.descriptionInput.validate(),0==Object.keys(this.configs).length?this.$q.notify({color:"negative",position:"top",message:"Choose the book type",icon:"error"}):""==this.manuscript.genre_name?this.$q.notify({color:"negative",position:"top",message:"Choose the book genre",icon:"error"}):this.$refs.titleInput.hasError||this.$refs.descriptionInput.hasError||!this.checkComponents||(this.manuscript.configs=this.configs,this.manuscript.front_matters=this.frontMatters,this.manuscript.chapters=this.chapters,this.manuscript.back_matters=this.backMatters,this.addManuscript(this.manuscript),this.$emit("done"))},checkComponents(){let e=!0;for(const t of this.frontMatters)""==t.title&&(e=!1);for(const t of this.chapters)""==t.title&&(e=!1);for(const t of this.backMatters)""==t.title&&(e=!1);return e},async addManuscript(e){let t=await this.$store.dispatch("write/addManuscript",e);t&&this.$router.push({name:"write-overview",params:{manuscript_id:t.data.id}})}}};var q=i(151),D=i(4689),V=i(3359),$=i(5869),T=i(8240),U=i(9367),x=i(7518),P=i.n(x);W.render=C,W.__scopeId="data-v-da193c0e";const L=W;P()(W,"components",{QCard:q.Z,QInput:D.Z,QSelect:V.Z,QSeparator:$.Z,QBtn:T.Z,QCardActions:U.Z});var Z=i(9978),S=i(3800),A=i(9407);const I={components:{AddManuscript:L,SimpleBookList:Z.Z,LinkingBox:A.Z,QuickBookLink:S.Z},name:"WritePage",data(){return{addManuscriptDialog:!1,publishedManuscripts:[],unpublishedManuscripts:[]}},mounted(){this.initData()},computed:{manuscripts(){return this.$store.getters["user/userProperty"]("manuscripts")},alignment(){return this.$q.screen.lt.md?"justify-center":"justify-start"}},methods:{initData(){for(const e of this.manuscripts)e.published?this.publishedManuscripts.push(e):this.unpublishedManuscripts.push(e);this.publishedManuscripts=this.publishedManuscripts.sort(((e,t)=>e.last_edited.localeCompare(t.last_edited))),this.unpublishedManuscripts=this.unpublishedManuscripts.sort(((e,t)=>e.last_edited.localeCompare(t.last_edited)))},async deleteManuscript(e){let t;t=await this.$api.delete("manuscripts/"+e.id),t=await this.$api.delete("default-book-prototypes/"+e.prototype_id),t=await this.$api.get("users/"+this.$store.getters["user/userProperty"]("id"),{params:{expand:"~all"}});let i=t.data;this.$store.commit("user/setUser",i)},onPrimaryClicked(e){this.$router.push({name:"write-overview",params:{manuscript_id:e.id}})},onSecondaryClicked(e){this.$router.push({name:"write-overview",params:{manuscript_id:e.id}})}}};var Q=i(4379),B=i(6778);I.render=p,I.__scopeId="data-v-1f3eb652";const j=I;P()(I,"components",{QPage:Q.Z,QDialog:B.Z})}}]);