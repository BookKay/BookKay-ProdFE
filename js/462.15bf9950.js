"use strict";(self["webpackChunkbookkay"]=self["webpackChunkbookkay"]||[]).push([[462],{6233:(e,t,i)=>{i.r(t),i.d(t,{default:()=>ae});var s=i(3673);const a=e=>((0,s.dD)("data-v-2c7d9939"),e=e(),(0,s.Cn)(),e),n=a((()=>(0,s._)("div",{class:"heading"},[(0,s._)("h1",null,"My Works")],-1))),o={key:0},l=a((()=>(0,s._)("h2",{class:"sub-heading last-write"},[(0,s.Uk)("Continue "),(0,s._)("b",null,"writing...")],-1))),r={key:1,class:"manuscripts-list"},c=a((()=>(0,s._)("h2",{class:"sub-heading"},[(0,s.Uk)(" Which manuscripts would you like to work "),(0,s._)("b",null,"today?")],-1))),d={key:2,class:"manuscripts-list"},p=a((()=>(0,s._)("h2",{class:"sub-heading"},[(0,s.Uk)(" Want to edit back your publised "),(0,s._)("b",null,"manuscripts?")],-1)));function u(e,t,i,a,u,m){const h=(0,s.up)("linking-card"),k=(0,s.up)("book-link"),g=(0,s.up)("book-list-swipeable"),b=(0,s.up)("manuscript-creation-form"),f=(0,s.up)("q-dialog"),y=(0,s.up)("q-page");return(0,s.wg)(),(0,s.j4)(y,null,{default:(0,s.w5)((()=>[n,(0,s._)("div",null,[(0,s.Wm)(h,{class:"write-link",mainText:"Just got an idea for the next best seller?",text:"Let's go write that down! What are you waiting for?",img:"svg/typewriter.svg",label:"Let's write!",onBtnClicked:t[0]||(t[0]=e=>u.addManuscriptDialog=!0)})]),u.unpublishedManuscripts.length>0?((0,s.wg)(),(0,s.iD)("div",o,[l,(0,s.Wm)(k,{book:u.unpublishedManuscripts[0],onBtnClicked:t[1]||(t[1]=e=>this.$router.push({name:"write-overview",params:{manuscript_id:u.unpublishedManuscripts[0].id}}))},null,8,["book"])])):(0,s.kq)("",!0),u.unpublishedManuscripts.length>1?((0,s.wg)(),(0,s.iD)("div",r,[c,(0,s.Wm)(g,{books:u.unpublishedManuscripts,primaryLabel:"Write",onPrimaryClicked:m.onPrimaryClicked,secondaryLabel:"Details",onSecondaryClicked:m.onSecondaryClicked},null,8,["books","onPrimaryClicked","onSecondaryClicked"])])):(0,s.kq)("",!0),u.publishedManuscripts.length>0?((0,s.wg)(),(0,s.iD)("div",d,[p,(0,s.Wm)(g,{books:u.publishedManuscripts,primaryLabel:"Edit",onPrimaryClicked:m.onPrimaryClicked,secondaryLabel:"Details",onSecondaryClicked:m.onSecondaryClicked},null,8,["books","onPrimaryClicked","onSecondaryClicked"])])):(0,s.kq)("",!0),(0,s.Wm)(f,{modelValue:u.addManuscriptDialog,"onUpdate:modelValue":t[3]||(t[3]=e=>u.addManuscriptDialog=e),class:"dialog"},{default:(0,s.w5)((()=>[(0,s.Wm)(b,{onDone:t[2]||(t[2]=e=>u.addManuscriptDialog=!1)})])),_:1},8,["modelValue"])])),_:1})}i(71),i(246);var m=i(8880);const h=e=>((0,s.dD)("data-v-6fc0347e"),e=e(),(0,s.Cn)(),e),k={class:"field"},g={class:"field"},b={class:"field"},f={class:"field"},y=h((()=>(0,s._)("div",{class:"q-ml-md"},[(0,s._)("h4",null,"Types")],-1))),_={class:"row q-mt-md"},w={key:0,class:"field component-list-item"},v={key:1,class:"field component-list-item"},C={key:2,class:"field component-list-item"},M={class:"field"};function W(e,t,i,a,n,o){const l=(0,s.up)("q-input"),r=(0,s.up)("genre-dropdown"),c=(0,s.up)("q-separator"),d=(0,s.up)("manuscript-type-choice"),p=(0,s.up)("q-btn"),u=(0,s.up)("q-card-actions"),h=(0,s.up)("q-card");return(0,s.wg)(),(0,s.j4)(h,{class:"container"},{default:(0,s.w5)((()=>[(0,s._)("div",k,[(0,s.Wm)(l,{outlined:"",color:"black",modelValue:n.manuscript.title,"onUpdate:modelValue":t[0]||(t[0]=e=>n.manuscript.title=e),label:"Title",ref:"titleInput",rules:[e=>!!e||"Title is required"]},null,8,["modelValue","rules"])]),(0,s._)("div",g,[(0,s.Wm)(l,{outlined:"",color:"black",modelValue:n.manuscript.description,"onUpdate:modelValue":t[1]||(t[1]=e=>n.manuscript.description=e),label:"Description",type:"textarea",ref:"descriptionInput",rules:[e=>!!e||"Description is required"]},null,8,["modelValue","rules"])]),(0,s._)("div",b,[(0,s.Wm)(r,{modelValue:n.manuscript.genre_name,"onUpdate:modelValue":t[2]||(t[2]=e=>n.manuscript.genre_name=e)},null,8,["modelValue"])]),(0,s.Wm)(c,{inset:""}),(0,s._)("div",f,[y,(0,s._)("div",_,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(this.bookTypes,(e=>((0,s.wg)(),(0,s.j4)(d,{class:"col-4",bookType:e,key:e.id,onTypeConfirmed:o.confirmType},null,8,["bookType","onTypeConfirmed"])))),128))]),(0,s.Wm)(m.W3,{name:"component-list",tag:"div"},{default:(0,s.w5)((()=>[n.configs.contain_front_matter?((0,s.wg)(),(0,s.iD)("div",w,[(0,s.Wm)(p,{label:"Add Front Matter",ripple:{early:!0},onClick:t[3]||(t[3]=e=>o.addComponent("frontMatters")),class:"add-btn"}),(0,s.Wm)(m.W3,{name:"list",tag:"div"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.frontMatters,((e,t)=>((0,s.wg)(),(0,s.iD)("div",{key:t,class:"list-item"},[(0,s.Wm)(l,{outlined:"",color:"black",modelValue:e.title,"onUpdate:modelValue":t=>e.title=t,class:"component-title q-mb-md",label:"Title",rules:[e=>!!e||"Title is required"]},null,8,["modelValue","onUpdate:modelValue","rules"]),(0,s.Wm)(p,{color:"negative",icon:"delete",ripple:{early:!0},class:"delete-btn",onClick:e=>o.deleteComponent("frontMatters",t)},null,8,["onClick"])])))),128))])),_:1})])):(0,s.kq)("",!0),n.configs.contain_chapter?((0,s.wg)(),(0,s.iD)("div",v,[(0,s.Wm)(p,{label:"Add Chapter",ripple:{early:!0},onClick:t[4]||(t[4]=e=>o.addComponent("chapters")),class:"add-btn"}),(0,s.Wm)(m.W3,{name:"list",tag:"div"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.chapters,((e,t)=>((0,s.wg)(),(0,s.iD)("div",{key:t,class:"list-item"},[(0,s.Wm)(l,{outlined:"",color:"black",modelValue:e.title,"onUpdate:modelValue":t=>e.title=t,class:"component-title q-mb-md",label:"Title",rules:[e=>!!e||"Title is required"]},null,8,["modelValue","onUpdate:modelValue","rules"]),(0,s.Wm)(p,{color:"negative",icon:"delete",ripple:{early:!0},class:"delete-btn",onClick:e=>o.deleteComponent("chapters",t)},null,8,["onClick"])])))),128))])),_:1})])):(0,s.kq)("",!0),n.configs.contain_back_matter?((0,s.wg)(),(0,s.iD)("div",C,[(0,s.Wm)(p,{label:"Add Back Matter",ripple:{early:!0},onClick:t[5]||(t[5]=e=>o.addComponent("backMatters")),class:"add-btn"}),(0,s.Wm)(m.W3,{name:"list",tag:"div"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.backMatters,((e,t)=>((0,s.wg)(),(0,s.iD)("div",{key:t,class:"list-item"},[(0,s.Wm)(l,{outlined:"",color:"black",modelValue:e.title,"onUpdate:modelValue":t=>e.title=t,class:"component-title q-mb-md",label:"Title",rules:[e=>!!e||"Title is required"]},null,8,["modelValue","onUpdate:modelValue","rules"]),(0,s.Wm)(p,{color:"negative",icon:"delete",ripple:{early:!0},class:"delete-btn",onClick:e=>o.deleteComponent("backMatters",t)},null,8,["onClick"])])))),128))])),_:1})])):(0,s.kq)("",!0)])),_:1}),(0,s._)("div",M,[(0,s.Wm)(u,{align:"right"},{default:(0,s.w5)((()=>[(0,s.Wm)(p,{color:"positive",label:"Confirm",icon:"edit",ripple:{early:!0},onClick:o.confirm},null,8,["onClick"])])),_:1})])])])),_:1})}var q=i(7329),D=i(2323);const T={class:"absolute-top-right"},V={class:"absolute-center"},$={class:"text-h6"};function Z(e,t,i,a,n,o){const l=(0,s.up)("q-btn"),r=(0,s.up)("q-card"),c=(0,s.up)("q-space"),d=(0,s.up)("q-card-section"),p=(0,s.up)("q-dialog"),u=(0,s.Q2)("ripple"),m=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.wy)(((0,s.wg)(),(0,s.j4)(r,{rounded:"",class:(0,D.C_)(["q-ma-sm relative-position type-card",e.$props.bookType.chosen?"bg-grey-4":""]),onClick:o.confirmType},{default:(0,s.w5)((()=>[(0,s._)("div",T,[(0,s.Wm)(l,{icon:"info",flat:"",rounded:"",padding:"none",onClick:t[0]||(t[0]=e=>n.show_hint=!0)})]),(0,s._)("div",V,(0,D.zw)(i.bookType.name),1)])),_:1},8,["onClick","class"])),[[u]]),(0,s.Wm)(p,{modelValue:n.show_hint,"onUpdate:modelValue":t[1]||(t[1]=e=>n.show_hint=e)},{default:(0,s.w5)((()=>[(0,s.Wm)(r,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,{class:"row items-center q-pb-none"},{default:(0,s.w5)((()=>[(0,s._)("div",$,(0,D.zw)(i.bookType.name),1),(0,s.Wm)(c),(0,s.wy)((0,s.Wm)(l,{icon:"close",flat:"",round:"",dense:""},null,512),[[m]])])),_:1}),(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,D.zw)(i.bookType.hint),1)])),_:1})])),_:1})])),_:1},8,["modelValue"])])}const U={name:"ManuscriptTypeChoice",props:{bookType:{type:Object,required:!0}},data(){return{show_hint:!1}},methods:{confirmType(){1!=this.show_hint&&this.$emit("typeConfirmed",this.$props.bookType.configs)}}};var Q=i(4260),P=i(151),x=i(8240),L=i(6778),S=i(5589),I=i(2025),j=i(860),A=i(677),B=i(7518),z=i.n(B);const F=(0,Q.Z)(U,[["render",Z],["__scopeId","data-v-6ea07a8a"]]),E=F;z()(U,"components",{QCard:P.Z,QBtn:x.Z,QDialog:L.Z,QCardSection:S.Z,QSpace:I.Z}),z()(U,"directives",{Ripple:j.Z,ClosePopup:A.Z});const K={name:"MakeManuscriptPage",components:{GenreDropdown:q.Z,ManuscriptTypeChoice:E},data(){return{configs:{},manuscript:{title:"",description:"",genre_name:"",temp_cover:"https://storage.googleapis.com/bookkay-dev.appspot.com/temp_covers/temp_cover.png",author_id:this.$store.getters["user/userProperty"]("id"),price:0,text:{}},genreOptions:[],bookTypes:[{id:"1",name:"Essay",configs:{contain_chapter:!1,contain_front_matter:!1,contain_back_matter:!1},hint:"A simple writing with no chapters.",chosen:!1},{id:"2",name:"Novel(Only chapters) ",configs:{contain_chapter:!0,contain_front_matter:!1,contain_back_matter:!1},hint:"A large long novels with several chapters.",chosen:!1},{id:"3",name:"Novel",configs:{contain_chapter:!0,contain_front_matter:!0,contain_back_matter:!0},hint:"A large long novels with several front matters, chapters and back matters.",chosen:!1}],frontMatters:[],chapters:[],backMatters:[]}},async mounted(){let e=await this.$api.get("genres"),t=e.data.results;for(const i of t)this.genreOptions.push(i.name)},methods:{confirmType(e){for(let t=0;t<this.bookTypes.length;t++){let i=this.bookTypes[t];i.configs==e?i.chosen=!0:i.chosen=!1}this.configs=e},capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)},addComponent(e){this[e].push({title:`${this.capitalizeFirstLetter(e).slice(0,-1)} - ${this[e].length+1}`,index:this[e].length,text:{time:1634195030352,blocks:[{id:"mEx28VKFcm",type:"heading",data:{text:`${this.capitalizeFirstLetter(e).slice(0,-1)} - ${this[e].length+1}`,level:3},tunes:{alignment:{alignment:"center"}}}],version:"2.22.2"}})},deleteComponent(e,t){let i=t;this[e].splice(t,1);for(const s of this[e])s.index>i&&s.index--},confirm(){this.$refs.titleInput.validate(),this.$refs.descriptionInput.validate(),0==Object.keys(this.configs).length?this.$q.notify({color:"negative",position:"top",message:"Choose the book type",icon:"error"}):""==this.manuscript.genre_name?this.$q.notify({color:"negative",position:"top",message:"Choose the book genre",icon:"error"}):this.$refs.titleInput.hasError||this.$refs.descriptionInput.hasError||!this.checkComponents||(this.manuscript.configs=this.configs,this.manuscript.front_matters=this.frontMatters,this.manuscript.chapters=this.chapters,this.manuscript.back_matters=this.backMatters,this.addManuscript(this.manuscript),this.$emit("done"))},checkComponents(){let e=!0;for(const t of this.frontMatters)""==t.title&&(e=!1);for(const t of this.chapters)""==t.title&&(e=!1);for(const t of this.backMatters)""==t.title&&(e=!1);return e},async addManuscript(e){let t=await this.$store.dispatch("write/addManuscript",e);t&&this.$router.push({name:"write-overview",params:{manuscript_id:t.data.id}})}}};var O=i(4842),H=i(1504),Y=i(5869),N=i(9367);const G=(0,Q.Z)(K,[["render",W],["__scopeId","data-v-6fc0347e"]]),J=G;z()(K,"components",{QCard:P.Z,QInput:O.Z,QSelect:H.Z,QSeparator:Y.Z,QBtn:x.Z,QCardActions:N.Z});var R=i(4496),X=i(994),ee=i(5542);const te={components:{ManuscriptCreationForm:J,BookListSwipeable:R.Z,LinkingCard:ee.Z,BookLink:X.Z},name:"WritePage",data(){return{addManuscriptDialog:!1,publishedManuscripts:[],unpublishedManuscripts:[]}},mounted(){this.initData()},computed:{manuscripts(){return this.$store.getters["user/userProperty"]("manuscripts")},alignment(){return this.$q.screen.lt.md?"justify-center":"justify-start"}},methods:{initData(){for(const e of this.manuscripts)e.published?this.publishedManuscripts.push(e):this.unpublishedManuscripts.push(e);this.publishedManuscripts=this.publishedManuscripts.sort(((e,t)=>e.last_edited.localeCompare(t.last_edited))),this.unpublishedManuscripts=this.unpublishedManuscripts.sort(((e,t)=>e.last_edited.localeCompare(t.last_edited)))},async deleteManuscript(e){let t;t=await this.$api.delete("manuscripts/"+e.id),t=await this.$api.delete("default-book-prototypes/"+e.prototype_id),t=await this.$api.get("users/"+this.$store.getters["user/userProperty"]("id"),{params:{expand:"~all"}});let i=t.data;this.$store.commit("user/setUser",i)},onPrimaryClicked(e){this.$router.push({name:"write-overview",params:{manuscript_id:e.id}})},onSecondaryClicked(e){this.$router.push({name:"write-overview",params:{manuscript_id:e.id}})}}};var ie=i(4379);const se=(0,Q.Z)(te,[["render",u],["__scopeId","data-v-2c7d9939"]]),ae=se;z()(te,"components",{QPage:ie.Z,QDialog:L.Z})}}]);